(()=>{"use strict";class t{constructor(t,i){this.container=t,this.settings={bgColor:"#f7f3e9",outlineColor:"#1a1a1a",numBlobs:5,blobSizeMin:15,blobSizeMax:35,riseSpeed:.3,wobble:5e-4,gooBlur:8,strokeWidth:3,animSpeed:1,gravity:5e-5,maxSpeed:.8,attractionForce:8e-4,explosionForce:.05,...i},this.canvas=t.querySelector("canvas"),this.canvas&&(this.ctx=this.canvas.getContext("2d"),this.canvas.width=209,this.canvas.height=708,this.blobs=[],this.animationFrameId=null,this.blockId=this.settings.blockId||"default",this.filterId=`goo-outline-${this.blockId}`,this.initBlobs(),this.applySettings(),this.animate=this.animate.bind(this),this.animate(),this.canvas.addEventListener("mousedown",t=>{const i=this.canvas.getBoundingClientRect(),s=(t.clientX-i.left)*(this.canvas.width/i.width),e=(t.clientY-i.top)*(this.canvas.height/i.height);this.explode(s,e)}))}updateSettings(t){this.settings={...this.settings,...t},"numBlobs"in t&&this.initBlobs(),this.applySettings()}destroy(){this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}initBlobs(){this.blobs=[];const t=Math.min(this.settings.numBlobs,15);for(let s=0;s<t;s++)this.blobs.push(new i(this.settings));this.blobs.push(new s(104,490,70,40,this.settings)),this.blobs.push(new s(104,115,35,20,this.settings))}applySettings(){this.container.style.setProperty("--bg-color",this.settings.bgColor),this.container.style.setProperty("--lamp-outline",this.settings.outlineColor);const t=this.container.querySelector(`#${this.filterId} feMorphology`);t&&t.setAttribute("radius",this.settings.strokeWidth);const i=this.container.querySelector(`#${this.filterId} feGaussianBlur`);i&&i.setAttribute("stdDeviation",this.settings.gooBlur);const s=this.container.querySelector("foreignObject");if(s){const t=this.settings.blockId||"default";s.setAttribute("clip-path",`url(#glass-clip-${t})`)}this.canvas&&(this.canvas.style.filter=`url(#${this.filterId})`)}explode(t,i){t||(t=this.canvas.width/2),i||(i=this.canvas.height/2),this.blobs.forEach(s=>{if(!s.fixed){const e=s.x-t,h=s.y-i,a=Math.sqrt(e*e+h*h)||.1,n=20*this.settings.explosionForce;s.vx+=e/a*n,s.vy+=h/a*n}})}animate(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.applyForces(),this.blobs.forEach(t=>{t.fixed||t.update(),t.draw(this.ctx)}),this.animationFrameId=requestAnimationFrame(this.animate)}applyForces(){for(let t=0;t<this.blobs.length;t++){if(!this.blobs[t].fixed){const i=this.settings.maxSpeed,s=Math.sqrt(this.blobs[t].vx*this.blobs[t].vx+this.blobs[t].vy*this.blobs[t].vy);s>i&&(this.blobs[t].vx=this.blobs[t].vx/s*i,this.blobs[t].vy=this.blobs[t].vy/s*i)}for(let i=t+1;i<this.blobs.length;i++){const s=this.blobs[t],e=this.blobs[i],h=e.x-s.x,a=e.y-s.y,n=Math.sqrt(h*h+a*a);if(0===n)continue;if(n<150){const t=(1-n/150)*this.settings.attractionForce*this.settings.animSpeed;s.fixed||(s.vx+=h/n*t,s.vy+=a/n*t),e.fixed||(e.vx-=h/n*t,e.vy-=a/n*t)}const o=s.r+e.r;if(n<o&&Math.sqrt((e.vx-s.vx)**2+(e.vy-s.vy)**2)>.6){const t=.02*(o-n);s.fixed||(s.vx-=h/n*t,s.vy-=a/n*t),e.fixed||(e.vx+=h/n*t,e.vy+=a/n*t)}}}}}class i{constructor(t){this.settings=t,this.reset()}reset(){const t=Math.random()>.5;this.x=104+80*(Math.random()-.5),t?(this.y=120+50*Math.random(),this.vy=.05+.1*Math.random(),this.state="falling"):(this.y=480+20*Math.random(),this.vy=-.05-Math.random()*this.settings.riseSpeed*.5,this.state="rising"),this.r=this.settings.blobSizeMin+Math.random()*(this.settings.blobSizeMax-this.settings.blobSizeMin),this.vx=.01*(Math.random()-.5),this.phase=Math.random()*Math.PI*2}update(){this.phase+=.005*this.settings.animSpeed,this.x+=(this.vx+Math.sin(this.phase)*(this.settings.wobble||5e-4))*this.settings.animSpeed,this.y+=this.vy*this.settings.animSpeed,this.vx+=1e-4*(104-this.x)*this.settings.animSpeed;const t=55+(this.y-100)/400*45,i=104-t,s=104+t;"rising"===this.state?this.y<130&&(this.y=130,this.vy=.3*Math.abs(this.vy),this.state="suspended"):"suspended"===this.state?(this.vy*=.995,Math.abs(this.vy)<.005&&(this.state=this.y<300?"falling":"rising")):"falling"===this.state&&(this.vy+=this.settings.gravity*this.settings.animSpeed,this.y>480&&(this.y=480,this.vy=.5*-Math.abs(this.vy)-.02,this.state="rising"));const e=i+10,h=s-10;this.x<e&&(this.x=e,this.vx*=-.5),this.x>h&&(this.x=h,this.vx*=-.5),this.y<120&&(this.y=120,this.vy*=-.5),this.y>480&&(this.y=480,this.vy*=-.5),this.x=Math.max(e,Math.min(h,this.x))}draw(t){t.fillStyle=this.settings.outlineColor,t.beginPath(),t.arc(this.x,this.y,this.r,0,2*Math.PI),t.fill()}}class s{constructor(t,i,s,e,h){this.x=t,this.y=i,this.rx=s,this.ry=e,this.vx=0,this.vy=0,this.r=(s+e)/2,this.fixed=!0,this.settings=h}update(){}draw(t){t.fillStyle=this.settings.outlineColor,t.beginPath(),t.ellipse(this.x,this.y,this.rx,this.ry,0,0,2*Math.PI),t.fill()}}function e(i=!1){window.hasLavaLampAnimationStarted&&!i||(window.hasLavaLampAnimationStarted=!0,document.querySelectorAll(".wp-block-antigravity-canvas-lava-lamp").forEach(s=>{if(s.dataset.initialized){if(!i)return;s.dataset.initialized=""}const e=s.querySelector(".lava-lamp-data");if(e)try{const i=JSON.parse(e.textContent);s.dataset.initialized="true",new t(s,i)}catch(t){}}))}var h=window.initializeOnPageCanvasAfterTransition;window.initializeOnPageCanvasAfterTransition=()=>{"function"==typeof h&&h(),e(!0)},window.addEventListener("wpLogoExplodeTransitionComplete",()=>{e(!0)}),window.addEventListener("load",()=>{document.querySelector(".transition-overlay")||e()})})();